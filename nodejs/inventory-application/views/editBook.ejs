<%- include("./partials/head") %>

<main class="editBook">
    <h1><% title %></h1>
    <form action=""
          method="post">
        <div class="formElement">
            <label for="title">Title:</label>
            <input name="title"
                   id="title"
                   type="text"
                   required
                   value="<%= locals?.formData?.title || '' %>">
            <label for="title"
                   class="error"><%= locals?.errors?.title?.msg %></label>
        </div>
        <div class="formElement">
            <label for="author">Author:</label>
            <input name="author"
                   id="author"
                   type="text"
                   required
                   value="<%= locals?.formData?.author || '' %>">
            <label for="author"
                   class="error"><%= locals?.errors?.author?.msg %></label>
        </div>
        <div class="formElement">
            <label for="year">Publication year:</label>
            <input name="year"
                   id="year"
                   type="number"
                   value="<%= locals?.formData?.year || '' %>">
            <label for="year"
                   class="error"><%= locals?.errors?.year?.msg %></label>
        </div>
        <div class="formElement">
            <label for="">Genres:</label>
            <div class="genres">
                <% for (const genre of genres) { %>
                <div class="genre">
                    <input name="genre"
                           id="genre-<%= genre.id %>"
                           type="checkbox"
                           value="<%= genre.id %>"
                           <% if (locals?.formData?.genre?.some((id) => id == genre.id)) { %>
                           <%= 'checked' %>
                           <% } %>>
                    <label for="genre-<%= genre.id %>"><%= genre.genre %></label>
                </div>
                <% } %>
            </div>
        </div>
        <div class="formElement">
            <label for="rating">Rating:</label>
            <input name="rating"
                   id="rating"
                   type="number"
                   step="0.01"
                   max=5
                   min=0
                   value="<%= locals?.formData?.rating || '' %>">
            <label for="rating"
                   class="error"><%= locals?.errors?.rating?.msg %></label>
        </div>
        <div class="formElement">
            <label for="pages">Pages:</label>
            <input name="pages"
                   id="pages"
                   type="number"
                   min=0
                   value="<%= locals?.formData?.pages || '' %>">
            <label for="pages"
                   class="error"><%= locals?.errors?.pages?.msg %></label>
        </div>
        <div class="formElement">
            <label for="cover_l">Cover large:</label>
            <input name="cover_l"
                   id="cover_l"
                   type="text"
                   value="<%= locals?.formData?.cover_l || '' %>">
            <label for="cover_l"
                   class="error"><%= locals?.errors?.cover_l?.msg %></label>
        </div>
        <div class="formElement">
            <label for="cover_s">Cover small:</label>
            <input name="cover_s"
                   id="cover_s"
                   type="text"
                   value="<%= locals?.formData?.cover_s || '' %>">
            <label for="cover_s"
                   class="error"><%= locals?.errors?.cover_s?.msg %></label>
        </div>
        <div class="formElement">
            <label for="description">Description:</label>
            <textarea name="description"
                      rows="10"
                      id="description"><%= locals?.formData?.description || ''%></textarea>
            <label for="description"
                   class="error"><%= locals?.errors?.description?.msg %></label>
        </div>

        <% if (!locals.new) { %>
        <div class="formElement">
            <label for="adminPwd">Admin password:</label>
            <input name="adminPwd"
                   id="adminPwd"
                   type="password">
            <label for="adminPwd"
                   class="error"><%= locals?.errors?.adminPwd?.msg %></label>
        </div>
        <% } %>

        <button class="actionButton"
                type="submit"><%= locals.new ? "Create book" : "Edit book" %></button>
    </form>
</main>

<%- include("./partials/footer") %>
